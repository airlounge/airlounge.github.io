<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Lab: Carl-Gustav Rossby</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap'); body { font-family: 'Noto Sans KR', sans-serif; }</style>
</head>
<body class="bg-indigo-50 text-slate-800">
    <nav class="bg-white border-b border-indigo-100 h-14 flex items-center px-4 sticky top-0 z-50">
        <a href="labs.html" class="flex items-center gap-2 text-slate-600 hover:text-indigo-600 font-bold">
            <i class="fa-solid fa-arrow-left"></i> 랩 목록
        </a>
    </nav>

    <div class="max-w-4xl mx-auto p-6">
        <header class="mb-8 text-center">
            <span class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide">Planetary Waves</span>
            <h1 class="text-3xl font-black mt-3 mb-2 text-slate-900">칼 구스타프 로스비 (Carl-Gustav Rossby)</h1>
            <p class="text-slate-600">편서풍 파동(Rossby Waves)과 절대소용돌이 보존 법칙을 정립했습니다.</p>
        </header>

        <div class="bg-white rounded-2xl shadow-xl border border-indigo-200 p-8">
            <div class="relative w-full aspect-video bg-slate-900 rounded-xl overflow-hidden mb-6 shadow-inner border border-slate-700">
                <canvas id="rossbyCanvas" class="w-full h-full block"></canvas>
                <div class="absolute bottom-4 left-4 text-white text-xs bg-black/50 px-2 py-1 rounded font-mono">
                    Phase Speed: Westward (Retrograding)
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <label class="block text-sm font-bold text-slate-700 mb-2">파수 (Wave Number, $n$): <span id="nVal" class="text-indigo-600">4</span></label>
                    <input type="range" id="waveNum" min="1" max="8" value="4" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-indigo-600">
                    <p class="text-xs text-slate-500 mt-1">지구를 감싸는 파동의 개수입니다.</p>
                </div>
                <div>
                    <label class="block text-sm font-bold text-slate-700 mb-2">진폭 (Amplitude): <span id="aVal" class="text-indigo-600">High</span></label>
                    <input type="range" id="amplitude" min="10" max="80" value="40" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-indigo-600">
                    <p class="text-xs text-slate-500 mt-1">남북으로 진동하는 폭입니다.</p>
                </div>
            </div>

            <div class="mt-6 bg-indigo-50 p-4 rounded-lg border border-indigo-100">
                <h4 class="font-bold text-indigo-800 mb-2">Rossby Wave Formula</h4>
                <p class="text-slate-700 text-sm">
                    $$ c = U - \frac{\beta}{k^2} $$
                </p>
                <p class="text-xs text-slate-500 mt-1">
                    파동의 위상속도($c$)는 평균 풍속($U$)보다 느리며, 파장이 길수록(파수 $k$가 작을수록) 서쪽으로 빠르게 이동하려 합니다.
                </p>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('rossbyCanvas');
        const ctx = canvas.getContext('2d');
        let width, height;

        function resize() {
            width = canvas.width = canvas.parentElement.offsetWidth;
            height = canvas.height = canvas.parentElement.offsetHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        const sliderN = document.getElementById('waveNum');
        const sliderA = document.getElementById('amplitude');
        const nVal = document.getElementById('nVal');
        
        let time = 0;

        function draw() {
            ctx.fillStyle = "#0f172a"; // slate-900 background
            ctx.fillRect(0,0,width,height);

            const n = parseInt(sliderN.value);
            const amp = parseInt(sliderA.value);
            nVal.innerText = n;
            
            const cx = width / 2;
            const cy = height / 2;
            const radius = Math.min(width, height) * 0.25;

            // 지구
            ctx.beginPath();
            ctx.strokeStyle = "rgba(255,255,255,0.1)";
            ctx.lineWidth = 1;
            ctx.arc(cx, cy, radius, 0, Math.PI*2);
            ctx.stroke();
            ctx.fillStyle = "rgba(59, 130, 246, 0.1)";
            ctx.fill();

            // 로스비 파동
            ctx.beginPath();
            ctx.strokeStyle = "#818cf8"; // indigo-400
            ctx.lineWidth = 4;

            for(let i=0; i<=360; i++) {
                const angle = (i * Math.PI) / 180;
                // 파동의 움직임 (서진)
                const r = radius + amp * Math.sin(n * angle + time); 
                const x = cx + r * Math.cos(angle);
                const y = cy + r * Math.sin(angle);
                
                if(i===0) ctx.moveTo(x,y);
                else ctx.lineTo(x,y);
            }
            ctx.closePath();
            ctx.stroke();

            time -= 0.01; // 반시계(서쪽) 방향 회전 흉내
            requestAnimationFrame(draw);
        }
        draw();
    </script>
</body>
</html>
